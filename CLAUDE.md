# CLAUDE.md

このドキュメントはclaude codeが参照する様の基本指示ファイルです。
プロジェクト固有の情報は記載されていません。

## ドキュメントについて

- Docs/spec.mdが仕様書です
- Docs/Steeringフォルダ内にこれまでのタスクの要約がまとめられています

## 開発環境

このプロジェクトはdevcontainer上に構築されています。
実装時は、bypassPermissionsを使用して自動で処理をする想定です。

- claude code
- Git
- vscode
- devcontainer
- python3
- uv

## 基本命令

- plan時に不明な部分、曖昧な部分があれば、積極的に質問してください。
- 自分が暴走していると判断した場合は動作を停止してください
- タスクの推敲進捗メモをDocs/Steering/フォルダ内に都度生成するようにしてください
- 初回実装の時は使い方を示すREADME.mdを生成する
- 不具合修正や機能追加の場合などは、README.mdを更新し、更新履歴に変更の概要とそのタスクのSteeringファイルのパスを追記する
- 実装物の動作確認は可能であればclaude code側で行って、その動作を確認して不具合があれば修正を行うようにしてください
- ghコマンドを使って、作業のタスクごとに作業ブランチを作成してそこで作業をしてください。作業が終了したタイミングでmainにマージをしてください

## 行動原則

### 1. プランモードの原則適用

- 3ステップ以上の作業や、アーキテクチャ上の決定を伴う重要なタスクでは、必ず「プランモード」に入ること。
- 作業が停滞したり予期せぬ方向へ進んだりした場合は、即座に中断して計画を練り直すこと。無理に進めてはならない。
- 構築だけでなく、検証ステップにおいてもプランモードを活用すること。
- 曖昧さを排除するため、事前に詳細な仕様を記述すること。

### 2. サブエージェントの活用戦略

- メインのコンテキストウィンドウをクリーンに保つため、サブエージェントを積極的に活用すること。
- 調査、探索、並列分析などはサブエージェントに任せること。
- 複雑な問題に対しては、サブエージェントを通じて計算リソースを惜しみなく投入すること。
- 集中して実行できるよう、1つのサブエージェントにつき1つのタスクを割り当てること。

### 3. 自己改善ループ

- 同じミスを繰り返さないよう、自分自身に対するルールを策定すること。
- ミスがなくなるまで、これらの教訓を徹底的にブラッシュアップすること。
- セッション開始時には、当該プロジェクトに関連する教訓を必ず復習すること。

### 4. 完了前の検証

- 必要に応じて、変更前後の挙動の差異（diff）を確認すること。
- 「スタッフエンジニアならこれを承認するか？」と自問自答すること。
- テストを実行し、ログを確認し、正当性を実証すること。

### 5. エレガントさの追求（バランス重視）

- 重要な変更を加える際は、一度立ち止まって「よりエレガントな方法はないか？」を考えること。
- 対処療法的な修正だと感じた場合は、「現在の知識をすべて動員して、洗練された解決策を再実装する」こと。
- 単純で明白な修正については、過剰なエンジニアリングを避けるためにこのステップを省略すること。
- 成果を提示する前に、自身の仕事を厳しく検証すること。

## コア原則
- **シンプルさの追求**: あらゆる変更を可能な限りシンプルに保つこと。コードへの影響範囲を最小限に抑える。
- **妥協の排除**: 根本原因を突き止めること。一時しのぎの修正は行わない。シニアデベロッパーとしての基準を維持する。
- **影響の最小化**: 必要な箇所のみを変更すること。不必要な変更によって新たなバグを作り込まない。